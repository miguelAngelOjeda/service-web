<div class="mat-button-single-row">
  <h2 class="breadcrumb2 m-l-2"><a class="previous" routerLink="/service-web/review"> ANALISIS SOLICITUDES </a> &gt; <span class="current">Visualizar</span></h2>
  <span  style="flex: 1 1 0%; box-sizing: border-box;"></span>
</div>
<mat-card class="form-card">
  <form [formGroup]="myForm">
    <mat-card-content *ngIf="myForm.get('propuestaSolicitud').value != null">
      <div class="row">
        <div class="col-md-12">
          <div class="d-flex flex-row comment-row ng-star-inserted">
            <div class="comment-text w-100">
              <div class="comment-footer">
                <div class="row">
                  <div class="col-md-6">
                    <span class="label label-info"><span class="font-bold">Nº ANALISIS: </span> {{myForm.get('id')?.value}}</span>
                  </div>
                  <div class="col-md-6">
                    <span class="text-muted pull-right" *ngIf="myForm.get('fechaInicioAnalisis')?.value"><span class="font-bold">Fecha Inicio: </span>{{myForm.get('fechaInicioAnalisis')?.value | date:'MM/dd/yyyy'}}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex flex-row comment-row ng-star-inserted m-t-10" *ngIf="myForm.get('funcionarioAnalisis')?.value">
            <div class="comment-text w-100">
              <div class="comment-footer">
                <span class="text-muted"><span class="font-bold">ANALISTA </span>{{
                  (myForm.get('funcionarioAnalisis')?.value?.persona.primerNombre == null ? '' : myForm.get('funcionarioAnalisis')?.value?.persona.primerNombre)
                  + ' ' +
                  (myForm.get('funcionarioAnalisis')?.value?.persona.segundoNombre == null ? '' : myForm.get('funcionarioAnalisis')?.value?.persona.segundoNombre)
                  + ' ' +
                  (myForm.get('funcionarioAnalisis')?.value?.persona.primerApellido == null ? '' : myForm.get('funcionarioAnalisis')?.value?.persona.primerApellido)
                  + ' ' +
                  (myForm.get('funcionarioAnalisis')?.value?.persona.segundoApellido == null ? '' : myForm.get('funcionarioAnalisis')?.value?.persona.segundoApellido)
                }}</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-12 m-t-20 m-b-20">
          <h4 class="m-0 font-20"><mat-icon class="gray-text">assessment</mat-icon>Propuesta</h4>
        </div>
        <div class="col-sm-12">
          <p mat-line><span class="font-bold">ASESOR </span> {{ ' ' +
            (myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.primerNombre == null ? '' : myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.primerNombre)
            + ' ' +
            (myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.segundoNombre == null ? '' : myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.segundoNombre)
            + ' ' +
            (myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.primerApellido == null ? '' : myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.primerApellido)
            + ' ' +
            (myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.segundoApellido == null ? '' : myForm.get('propuestaSolicitud')?.value?.funcionario?.persona.segundoApellido)
          }}
        </p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">Nº SOLICITUD</span> {{myForm.get('propuestaSolicitud')?.value.id}}</p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">FECHA PRESENTACION</span> {{myForm.get('propuestaSolicitud')?.value.fechaPresentacion | date:'MM/dd/yyyy'}}</p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">MONTO</span> {{myForm.get('propuestaSolicitud')?.value.montoSolicitado | number}}</p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">TIPO GARANTIA</span> {{myForm.get('propuestaSolicitud')?.value?.tipoGarantia.nombre}}</p>
      </div>
      <div class="col-md-3">
        <p mat-line><span class="font-bold">PLAZO</span> {{myForm.get('propuestaSolicitud')?.value.plazo}}</p>
      </div>
      <div class="col-md-3">
        <p mat-line><span class="font-bold">CUOTA</span> {{myForm.get('propuestaSolicitud')?.value.importeCuota | number}}</p>
      </div>
      <div class="col-md-3">
        <p mat-line><span class="font-bold">TASA(%)</span> {{myForm.get('propuestaSolicitud')?.value.tasaInteres}}</p>
      </div>
      <div class="col-md-3">
        <p mat-line><span class="font-bold">GASTOS ADMINISTRATIVOS(%)</span> {{myForm.get('propuestaSolicitud')?.value.gastosAdministrativos}}</p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">TIPO CALCULO</span> {{myForm.get('propuestaSolicitud')?.value?.tipoCalculoImporte.nombre}}</p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">FORMA PAGO</span> {{myForm.get('propuestaSolicitud')?.value?.tipoPago.nombre}}</p>
      </div>
      <div class="col-md-3">
        <p mat-line><span class="font-bold">PERIODO GRACIA</span> {{myForm.get('propuestaSolicitud')?.value.periodoGracia}}</p>
      </div>
      <div class="col-sm-3">
        <p mat-line><span class="font-bold">DESTINO</span> {{myForm.get('propuestaSolicitud')?.value?.tipoDestino.nombre}}</p>
      </div>
      <div class="col-sm-6" *ngIf="myForm.get('propuestaSolicitud')?.value.detalleDestino">
        <p mat-line><span class="font-bold">ACLARACION DESTINO</span> {{myForm.get('propuestaSolicitud')?.value.detalleDestino}}</p>
      </div>
      <div class="col-md-6" *ngIf="myForm.get('propuestaSolicitud')?.value.observacionesDepartamento">
        <p mat-line><span class="font-bold">OBSERVACION</span> {{myForm.get('propuestaSolicitud')?.value.observacionesDepartamento}}</p>
      </div>
      <div class="col-md-12  m-t-10" *ngIf="myForm.get('propuestaSolicitud')?.value.id && myForm.get('propuestaSolicitud')?.value.entidad">
        <app-view-upload [entidad]="myForm.get('propuestaSolicitud')?.value.entidad" [idEntidad]="myForm.get('propuestaSolicitud')?.value.id"></app-view-upload>
      </div>
      <div class="col-md-12 m-t-10">
        <h4  class="m-b-10 font-20"><mat-icon class="gray-text">group</mat-icon>Solicitantes
        </h4>
      </div>
      <div class="col-md-12">
        <div formArrayName="detalles">
          <div [formGroupName]="i" *ngFor="let detalle of myForm.get('detalles').controls; let i = index">
            <fieldset class="m-t-20">
              <legend>{{detalle.controls['tipoRelacion']?.value }}</legend>
              <div class="row">
                <div class="col-md-10">
                  <div class="p-l-20 p-t-10">
                    <div class="font-medium">{{
                      (detalle.get('persona')?.value.primerNombre == null ? '' : detalle.get('persona')?.value.primerNombre)
                      + ' ' +
                      (detalle.get('persona')?.value.segundoNombre == null ? '' : detalle.get('persona')?.value.segundoNombre)
                      + ' ' +
                      (detalle.get('persona')?.value.primerApellido == null ? '' : detalle.get('persona')?.value.primerApellido)
                      + ' ' +
                      (detalle.get('persona')?.value.segundoApellido == null ? '' : detalle.get('persona')?.value.segundoApellido)
                    }} </div>
                    <span class="font-16" *ngIf="detalle.controls['profesion']?.value">{{detalle.controls['profesion']?.value?.nombre}}</span>
                    <br *ngIf="detalle.controls['profesion']?.value">
                    <span class="font-16" *ngIf="detalle.controls['persona']?.value.email">{{detalle.controls['persona']?.value.email }}</span>
                    <br>
                    <span class="font-16" *ngIf="detalle.controls['persona']?.value.telefonoParticular">Telf. {{
                      (detalle.controls['persona']?.value.telefonoParticular == null ? '' : detalle.controls['persona']?.value.telefonoParticular)
                      + ' ' +
                      (detalle.controls['persona']?.value.telefonoSecundario == null ? '' : detalle.controls['persona']?.value.telefonoSecundario)
                    }}</span>
                    <br>
                    <span class="font-16 font-bold" *ngIf="detalle.controls['tipoRelacion']?.value">{{detalle.controls['tipoRelacion']?.value }}</span>
                    <button type="button" class="btn btn-light btn-sm pull-right" (click)="viewPeople(myForm.get('propuestaSolicitud')?.value.id,detalle.controls['persona']?.value.id, detalle.controls['tipoRelacion']?.value)">Más Informacion <i class="fa fa-search" aria-hidden="true"></i></button>
                  </div>
                </div>
                <div class="col-md-12 m-t-10">
                  <div class="row">
                    <div class="col-md-6">
                      <fieldset >
                        <legend>Detalle Monetario(Solicitud)</legend>
                        <div class="row">
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Solicitud Cuota: </span> {{detalle.get('montoDeudaSolicitudCuotas').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Solicitud Total: </span> {{detalle.get('montoDeudaSolicitud').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Desc. Cuota: </span> {{detalle.get('montoDeudaDescuentoCuotas').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Desc. Total: </span> {{detalle.get('montoDeudaDescuento').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">DEUDA TOTAL </span> {{detalle.get('montoDeudaSolicitudCuotaTotal').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">DEUDA TOTAL </span> {{detalle.get('montoDeudaSolicitudTotal').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Ingresos: </span> {{detalle.get('ingresoTotal').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Ingresos 40%: </span> {{detalle.get('porcentajeCapacidad').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Otros Ingresos: </span> {{detalle.get('ingresosOtros').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Otros 100%: </span> {{detalle.get('porcentajeCapacidadOtros').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">TOTAL </span> {{detalle.get('montoTotalIngresos').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">TOTAL </span> {{detalle.get('montoTotalIngresosPorcentaje').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">DIFERENCIA </span> {{detalle.get('saldoTotalSolicitud').value | number}}</p>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                    <div class="col-md-6">
                      <fieldset >
                        <legend>Detalle Monetario</legend>
                        <div class="row">
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Saldo Cuota: </span> {{detalle.get('montoDeudaCuotas').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Saldo Total: </span> {{detalle.get('montoDeuda').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Tarjeta Cuota: </span> {{detalle.get('montoDeudaTarjetaMinimo').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Tarjeta Total: </span> {{detalle.get('montoDeudaTarjeta').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Saldo Cony. Cuota: </span> {{detalle.get('montoDeudaCuotasConyuge').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Saldo Cony. Total: </span> {{detalle.get('montoDeudaConyuge').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Tarjeta Cony. Cuota: </span> {{detalle.get('montoDeudaTarjetaMinimoConyuge').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Tarjeta Cony. Total: </span> {{detalle.get('montoDeudaTarjetaConyuge').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">TOTAL CUOTA </span> {{detalle.get('montoDeudaTotalCuota').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">TOTAL </span> {{detalle.get('montoDeudaTotal').value | number}}</p>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                    <div class="col-md-12 m-t-10">
                      <fieldset>
                        <legend>Referencia</legend>
                        <div class="row">
                          <div class="col-md-12">
                            <mat-card-content  class="mat-card-content">
                              <div class="d-flex no-block">
                                <div class="m-r-10 no-shrink">
                                  <button type="button"class="shadow-none bg-warning mat-fab mat-warn" color="warn" style="padding: inherit;"
                                   (click)="reportInformconf(myForm.get('propuestaSolicitud')?.value.id,detalle.get('persona')?.value.documento, myForm.get('propuestaSolicitud')?.value?.tipoSolicitud.nombre,false)">
                                    <span class="mat-button-wrapper">
                                      <mat-icon class="mat-icon notranslate material-icons mat-icon-no-color" role="img" aria-hidden="true">search</mat-icon>
                                    </span>
                                    <div class="mat-button-ripple mat-ripple mat-button-ripple-round" matripple=""></div>
                                    <div class="mat-button-focus-overlay"></div>
                                  </button>
                                </div>
                                <div>
                                  <h3 class="m-0">{{detalle.get('fajaInformconf').value }}</h3>
                                  <h6 class="text-muted m-0">FAJA INFORMCONF</h6>
                                </div>
                              </div>
                            </mat-card-content>
                          </div>
                          <div class="col-md-12">
                            <mat-form-field>
                              <textarea matInput placeholder="Detalle Informconf" formControlName="informconf" name="informconf"></textarea>
                              <mat-error *ngIf="(detalle.get('informconf').errors)">
                                <span *ngIf="detalle.get('informconf').errors.required">
                                 Campo requerido
                                </span>
                              </mat-error>
                            </mat-form-field>
                          </div>
                          <div class="col-md-12">
                            <mat-form-field>
                              <textarea matInput placeholder="Referencia" formControlName="observacionReferencia" name="observacionReferencia"></textarea>
                            </mat-form-field>
                          </div>
                          <div class="col-md-4">
                            <p mat-line><span class="font-bold">CREDITO VIGENTE </span> {{detalle.get('creditoVigente').value | number}}</p>
                          </div>
                          <div class="col-md-4">
                            <p mat-line><span class="font-bold">GARANTIA CREDITO </span> {{detalle.get('garantiasVigente').value}}</p>
                          </div>
                          <div class="col-md-4">
                            <p mat-line><span class="font-bold">CALIFICACION ULT. CREDITOS </span> {{detalle.get('calificacionCredCanc').value}}</p>
                          </div>
                          <div class="col-md-4">
                            <p mat-line><span class="font-bold">CAPACIDAD PAGO: </span> {{detalle.get('capacidadPago').value | number}}</p>
                          </div>
                          <div class="col-md-2">
                            <p mat-line><span class="font-bold">ANTIGUEDAD LABORAL </span> {{detalle.get('antiguedadLaboral').value}}</p>
                          </div>
                          <div class="col-md-2">
                            <p mat-line><span class="font-bold">EDAD </span> {{detalle.get('edad').value}}</p>
                          </div>
                          <div class="col-md-2">
                            <p mat-line> <span class="font-bold">Nº HIJOS </span> {{detalle.get('cantidadHijos').value}}</p>
                          </div>
                          <div class="col-md-2">
                            <p mat-line><span class="font-bold">ESTADO CIVIL </span> {{detalle.get('estadoCivil').value}}</p>
                          </div>
                          <div class="col-md-12">
                            <mat-form-field>
                              <textarea matInput placeholder="Datos Relevantes" formControlName="datosRelevantes" name="datosRelevantes"></textarea>
                            </mat-form-field>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Deuda Referencia Cuota: </span> {{detalle.get('deudaCuotaReferencia').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Deuda Referencia Total: </span> {{detalle.get('deudaTotalReferencia').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Ctral. Riesgo Cuota: </span> {{detalle.get('deudaCuotaCtralRgo').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-normal">Ctral. Riesgo Total: </span> {{detalle.get('deudaTotalCtralRgo').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">TOTAL DEUDA EXT. </span> {{detalle.get('totalDeudaCuotaExterior').value | number}}</p>
                          </div>
                          <div class="col-md-6">
                            <p mat-line><span class="font-bold">TOTAL DEUDA EXT. </span> {{detalle.get('totalDeudaExterior').value | number}}</p>
                          </div>
                        </div>
                      </fieldset>
                    </div>
                  </div>
                </div>
              </div>
            </fieldset>
          </div>
        </div>
      </div>
      <div class="col-md-12 m-t-20">
        <fieldset>
          <legend>Recomendación del Analista de Creditos</legend>
          <div class="row">
            <div class="col-md-12">
              <mat-form-field>
                <textarea matInput placeholder="Recomendación" formControlName="observacionRecomendacion" name="observacionRecomendacion"></textarea>
              </mat-form-field>
            </div>
            <div class="col-md-12">
              <mat-form-field>
                <textarea matInput placeholder="Observación Desembolso" formControlName="observacion" name="observacion"></textarea>
              </mat-form-field>
            </div>
            <div class="col-md-12">
              <p mat-line><span class="font-bold">ESTADO ANALISIS </span> {{myForm.get('estado').value?.nombre}}</p>
            </div>
            <div class="col-md-12 m-t-10" *ngIf="myForm.get('estado')?.value.id == 6">
              <fieldset>
                <legend>Resolución Aprobación</legend>
                <div class="row">
                  <div class="col-md-4">
                    <p mat-line><span class="font-bold">MONTO APROBADO </span> {{myForm.get('montoAprobado').value | number}}</p>
                  </div>
                  <div class="col-md-12">
                    <mat-form-field>
                      <textarea matInput placeholder="Observación Aprobación" formControlName="obsApro" name="obsApro" required></textarea>
                      <mat-error *ngIf="(myForm.get('obsApro').errors)">
                        <span *ngIf="myForm.get('obsApro').errors.required">
                          Campo requerido
                        </span>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </fieldset>
            </div>
            <div class="col-md-12 m-t-10" *ngIf="myForm.get('estado')?.value.id == 5">
              <fieldset>
                <legend>Observación Retransferencia</legend>
                <div class="row">
                  <div class="col-md-12">
                    <mat-form-field>
                      <textarea matInput placeholder="Observación" formControlName="observacionRetransferencia" name="observacionRetransferencia" required></textarea>
                      <mat-error *ngIf="(myForm.get('observacionRetransferencia').errors)">
                        <span *ngIf="myForm.get('observacionRetransferencia').errors.required">
                          Campo requerido
                        </span>
                      </mat-error>
                    </mat-form-field>
                  </div>
                </div>
              </fieldset>
            </div>
          </div>
        </fieldset>
      </div>
    </div>
  </mat-card-content>
</form>
</mat-card>
